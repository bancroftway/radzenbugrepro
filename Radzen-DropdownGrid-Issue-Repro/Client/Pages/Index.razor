@page "/"
@using Radzen_DropdownGrid_Issue_Repro.Client
@using Radzen_DropdownGrid_Issue_Repro.Client.Components


@if (Metadata?.Any() == true)
{
    var metadataKeyNames = Metadata.Select(x => x.DisplayName).Distinct();
    @foreach (var metaDataKey in metadataKeyNames)
    {
        var metaDataValues = Metadata.Where(x => x.DisplayName == metaDataKey && !string.IsNullOrEmpty(x.Value));

        if (metaDataValues?.Any() == true)
        {
            var ncp = metaDataValues.Select(x => x.Value).GroupBy(x => x).Select(g => new NameCountPair(g.Key, g.Count())).OrderBy(x => x.Name);

            <EntityFilterCmp EntityList="@ncp" EntityName="@metaDataKey" SelectedEntitiesChanged="@SelectedMetadatasChanged"></EntityFilterCmp>
        }
    }
}


@code {
    private IEnumerable<MetadataDto> Metadata;

    protected override async Task OnInitializedAsync()
    {
        Metadata = new List<MetadataDto>
        {
            new MetadataDto{DisplayName="Supplier", Value="ABC Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Ottawa, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Doe" },
            new MetadataDto{DisplayName="Facility", Value="Cafeteria" },
            new MetadataDto{DisplayName="Supplier", Value="XYZ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Toronto, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Adams" },
            new MetadataDto{DisplayName="Facility", Value="Bus Station" },
            new MetadataDto{DisplayName="Supplier", Value="DEF Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Houston, TX" },
            new MetadataDto{DisplayName="Project Manager", Value="Jane Doe" },
            new MetadataDto{DisplayName="Facility", Value="Gas Station" },
            new MetadataDto{DisplayName="Supplier", Value="GHI Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="New York, NY" },
            new MetadataDto{DisplayName="Project Manager", Value="James Smith" },
            new MetadataDto{DisplayName="Facility", Value="Hospital" },
            new MetadataDto{DisplayName="Supplier", Value="JKL Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="London, UK" },
            new MetadataDto{DisplayName="Project Manager", Value="Emily Johnson" },
            new MetadataDto{DisplayName="Facility", Value="School" },
            new MetadataDto{DisplayName="Supplier", Value="MNO Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Sydney, Australia" },
            new MetadataDto{DisplayName="Project Manager", Value="Michael Brown" },
            new MetadataDto{DisplayName="Facility", Value="Airport" },
            new MetadataDto{DisplayName="Supplier", Value="PQR Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Berlin, Germany" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophia Davis" },
            new MetadataDto{DisplayName="Facility", Value="Museum" },
            new MetadataDto{DisplayName="Supplier", Value="STU Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Tokyo, Japan" },
            new MetadataDto{DisplayName="Project Manager", Value="Oliver Wilson" },
            new MetadataDto{DisplayName="Facility", Value="Park" },
            new MetadataDto{DisplayName="Supplier", Value="VWX Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Paris, France" },
            new MetadataDto{DisplayName="Project Manager", Value="Ava Martinez" },
            new MetadataDto{DisplayName="Facility", Value="Theater" },
            new MetadataDto{DisplayName="Supplier", Value="YZA Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rome, Italy" },
            new MetadataDto{DisplayName="Project Manager", Value="Liam Anderson" },
            new MetadataDto{DisplayName="Facility", Value="Library" },
            new MetadataDto{DisplayName="Supplier", Value="BCD Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Madrid, Spain" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Garcia" },
            new MetadataDto{DisplayName="Facility", Value="Stadium" },
            new MetadataDto{DisplayName="Supplier", Value="EFG Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Beijing, China" },
            new MetadataDto{DisplayName="Project Manager", Value="Noah Wang" },
            new MetadataDto{DisplayName="Facility", Value="Shopping Mall" },
            new MetadataDto{DisplayName="Supplier", Value="HIJ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Moscow, Russia" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophie Ivanova" },
            new MetadataDto{DisplayName="Facility", Value="Gym" },
            new MetadataDto{DisplayName="Supplier", Value="KLM Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Cairo, Egypt" },
            new MetadataDto{DisplayName="Project Manager", Value="Muhammad Ali" },
            new MetadataDto{DisplayName="Facility", Value="Mosque" },
            new MetadataDto{DisplayName="Supplier", Value="NOP Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Mexico City, Mexico" },
            new MetadataDto{DisplayName="Project Manager", Value="Sofia Hernandez" },
            new MetadataDto{DisplayName="Facility", Value="Zoo" },
            new MetadataDto{DisplayName="Supplier", Value="QRS Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Delhi, India" },
            new MetadataDto{DisplayName="Project Manager", Value="Aarav Verma" },
            new MetadataDto{DisplayName="Facility", Value="Temple" },
            new MetadataDto{DisplayName="Supplier", Value="TUV Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rio de Janeiro, Brazil" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Silva" },
            new MetadataDto{DisplayName="Facility", Value="Beach" },
            new MetadataDto{DisplayName="Supplier", Value="WXY Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Seoul, South Korea" },
            new MetadataDto{DisplayName="Project Manager", Value="Minji Kim" },
            new MetadataDto{DisplayName="Facility", Value="Cinema" },
            new MetadataDto{DisplayName="Supplier", Value="ZAB Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Athens, Greece" },
            new MetadataDto{DisplayName="Project Manager", Value="Nikos Papadopoulos" },
            new MetadataDto{DisplayName="Facility", Value="Restaurant" },
            new MetadataDto{DisplayName="Supplier", Value="ABC Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Ottawa, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Doe" },
            new MetadataDto{DisplayName="Facility", Value="Cafeteria" },
            new MetadataDto{DisplayName="Supplier", Value="XYZ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Toronto, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Adams" },
            new MetadataDto{DisplayName="Facility", Value="Bus Station" },
            new MetadataDto{DisplayName="Supplier", Value="DEF Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Houston, TX" },
            new MetadataDto{DisplayName="Project Manager", Value="Jane Doe" },
            new MetadataDto{DisplayName="Facility", Value="Gas Station" },
            new MetadataDto{DisplayName="Supplier", Value="GHI Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="New York, NY" },
            new MetadataDto{DisplayName="Project Manager", Value="James Smith" },
            new MetadataDto{DisplayName="Facility", Value="Hospital" },
            new MetadataDto{DisplayName="Supplier", Value="JKL Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="London, UK" },
            new MetadataDto{DisplayName="Project Manager", Value="Emily Johnson" },
            new MetadataDto{DisplayName="Facility", Value="School" },
            new MetadataDto{DisplayName="Supplier", Value="MNO Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Sydney, Australia" },
            new MetadataDto{DisplayName="Project Manager", Value="Michael Brown" },
            new MetadataDto{DisplayName="Facility", Value="Airport" },
            new MetadataDto{DisplayName="Supplier", Value="PQR Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Berlin, Germany" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophia Davis" },
            new MetadataDto{DisplayName="Facility", Value="Museum" },
            new MetadataDto{DisplayName="Supplier", Value="STU Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Tokyo, Japan" },
            new MetadataDto{DisplayName="Project Manager", Value="Oliver Wilson" },
            new MetadataDto{DisplayName="Facility", Value="Park" },
            new MetadataDto{DisplayName="Supplier", Value="VWX Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Paris, France" },
            new MetadataDto{DisplayName="Project Manager", Value="Ava Martinez" },
            new MetadataDto{DisplayName="Facility", Value="Theater" },
            new MetadataDto{DisplayName="Supplier", Value="YZA Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rome, Italy" },
            new MetadataDto{DisplayName="Project Manager", Value="Liam Anderson" },
            new MetadataDto{DisplayName="Facility", Value="Library" },
            new MetadataDto{DisplayName="Supplier", Value="BCD Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Madrid, Spain" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Garcia" },
            new MetadataDto{DisplayName="Facility", Value="Stadium" },
            new MetadataDto{DisplayName="Supplier", Value="EFG Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Beijing, China" },
            new MetadataDto{DisplayName="Project Manager", Value="Noah Wang" },
            new MetadataDto{DisplayName="Facility", Value="Shopping Mall" },
            new MetadataDto{DisplayName="Supplier", Value="HIJ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Moscow, Russia" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophie Ivanova" },
            new MetadataDto{DisplayName="Facility", Value="Gym" },
            new MetadataDto{DisplayName="Supplier", Value="KLM Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Cairo, Egypt" },
            new MetadataDto{DisplayName="Project Manager", Value="Muhammad Ali" },
            new MetadataDto{DisplayName="Facility", Value="Mosque" },
            new MetadataDto{DisplayName="Supplier", Value="NOP Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Mexico City, Mexico" },
            new MetadataDto{DisplayName="Project Manager", Value="Sofia Hernandez" },
            new MetadataDto{DisplayName="Facility", Value="Zoo" },
            new MetadataDto{DisplayName="Supplier", Value="QRS Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Delhi, India" },
            new MetadataDto{DisplayName="Project Manager", Value="Aarav Verma" },
            new MetadataDto{DisplayName="Facility", Value="Temple" },
            new MetadataDto{DisplayName="Supplier", Value="TUV Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rio de Janeiro, Brazil" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Silva" },
            new MetadataDto{DisplayName="Facility", Value="Beach" },
            new MetadataDto{DisplayName="Supplier", Value="WXY Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Seoul, South Korea" },
            new MetadataDto{DisplayName="Project Manager", Value="Minji Kim" },
            new MetadataDto{DisplayName="Facility", Value="Cinema" },
            new MetadataDto{DisplayName="Supplier", Value="ZAB Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Athens, Greece" },
            new MetadataDto{DisplayName="Project Manager", Value="Nikos Papadopoulos" },
            new MetadataDto{DisplayName="Facility", Value="Restaurant" },
            new MetadataDto{DisplayName="Supplier", Value="ABC Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Ottawa, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Doe" },
            new MetadataDto{DisplayName="Facility", Value="Cafeteria" },
            new MetadataDto{DisplayName="Supplier", Value="XYZ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Toronto, ON" },
            new MetadataDto{DisplayName="Project Manager", Value="John Adams" },
            new MetadataDto{DisplayName="Facility", Value="Bus Station" },
            new MetadataDto{DisplayName="Supplier", Value="DEF Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Houston, TX" },
            new MetadataDto{DisplayName="Project Manager", Value="Jane Doe" },
            new MetadataDto{DisplayName="Facility", Value="Gas Station" },
            new MetadataDto{DisplayName="Supplier", Value="GHI Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="New York, NY" },
            new MetadataDto{DisplayName="Project Manager", Value="James Smith" },
            new MetadataDto{DisplayName="Facility", Value="Hospital" },
            new MetadataDto{DisplayName="Supplier", Value="JKL Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="London, UK" },
            new MetadataDto{DisplayName="Project Manager", Value="Emily Johnson" },
            new MetadataDto{DisplayName="Facility", Value="School" },
            new MetadataDto{DisplayName="Supplier", Value="MNO Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Sydney, Australia" },
            new MetadataDto{DisplayName="Project Manager", Value="Michael Brown" },
            new MetadataDto{DisplayName="Facility", Value="Airport" },
            new MetadataDto{DisplayName="Supplier", Value="PQR Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Berlin, Germany" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophia Davis" },
            new MetadataDto{DisplayName="Facility", Value="Museum" },
            new MetadataDto{DisplayName="Supplier", Value="STU Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Tokyo, Japan" },
            new MetadataDto{DisplayName="Project Manager", Value="Oliver Wilson" },
            new MetadataDto{DisplayName="Facility", Value="Park" },
            new MetadataDto{DisplayName="Supplier", Value="VWX Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Paris, France" },
            new MetadataDto{DisplayName="Project Manager", Value="Ava Martinez" },
            new MetadataDto{DisplayName="Facility", Value="Theater" },
            new MetadataDto{DisplayName="Supplier", Value="YZA Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rome, Italy" },
            new MetadataDto{DisplayName="Project Manager", Value="Liam Anderson" },
            new MetadataDto{DisplayName="Facility", Value="Library" },
            new MetadataDto{DisplayName="Supplier", Value="BCD Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Madrid, Spain" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Garcia" },
            new MetadataDto{DisplayName="Facility", Value="Stadium" },
            new MetadataDto{DisplayName="Supplier", Value="EFG Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Beijing, China" },
            new MetadataDto{DisplayName="Project Manager", Value="Noah Wang" },
            new MetadataDto{DisplayName="Facility", Value="Shopping Mall" },
            new MetadataDto{DisplayName="Supplier", Value="HIJ Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Moscow, Russia" },
            new MetadataDto{DisplayName="Project Manager", Value="Sophie Ivanova" },
            new MetadataDto{DisplayName="Facility", Value="Gym" },
            new MetadataDto{DisplayName="Supplier", Value="KLM Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Cairo, Egypt" },
            new MetadataDto{DisplayName="Project Manager", Value="Muhammad Ali" },
            new MetadataDto{DisplayName="Facility", Value="Mosque" },
            new MetadataDto{DisplayName="Supplier", Value="NOP Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Mexico City, Mexico" },
            new MetadataDto{DisplayName="Project Manager", Value="Sofia Hernandez" },
            new MetadataDto{DisplayName="Facility", Value="Zoo" },
            new MetadataDto{DisplayName="Supplier", Value="QRS Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Delhi, India" },
            new MetadataDto{DisplayName="Project Manager", Value="Aarav Verma" },
            new MetadataDto{DisplayName="Facility", Value="Temple" },
            new MetadataDto{DisplayName="Supplier", Value="TUV Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Rio de Janeiro, Brazil" },
            new MetadataDto{DisplayName="Project Manager", Value="Isabella Silva" },
            new MetadataDto{DisplayName="Facility", Value="Beach" },
            new MetadataDto{DisplayName="Supplier", Value="WXY Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Seoul, South Korea" },
            new MetadataDto{DisplayName="Project Manager", Value="Minji Kim" },
            new MetadataDto{DisplayName="Facility", Value="Cinema" },
            new MetadataDto{DisplayName="Supplier", Value="ZAB Supplier" },
            new MetadataDto{DisplayName="SiteName", Value="Athens, Greece" },
            new MetadataDto{DisplayName="Project Manager", Value="Nikos Papadopoulos" },
            new MetadataDto{DisplayName="Facility", Value="Restaurant" }
        };
    }

    private async Task SelectedMetadatasChanged((string key, IEnumerable<string> values) entities)
    {
        // if (entities.values != null && entities.values.Any())
        // {
        //     Console.WriteLine($"{entities.values.Count()} entities selected for key {entities.key}");
        // }
    }
}